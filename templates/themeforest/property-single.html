<!-- /*
* Template Name: Property
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->

<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Untree.co" />
    <link rel="shortcut icon" href="{% static 'tf/images/favicon.ico' %}" />

    <meta name="description" content="Come and get homed on DaRentals. Or you can come and upload your own rentals for tenants to find">
    <meta property="og:title" content="{{rental.address}} â€“ DaRentals" />
    <meta property="og:description" content="{{ rental.details }}" />
    <meta property="keywords" content="room to rent, rental, rooms, apartment, rent, landlord, DaRentals, darentals">

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="{% static 'tf/fonts/icomoon/style.css' %}" />
    <link rel="stylesheet" href="{% static 'tf/fonts/flaticon/font/flaticon.css' %}" />

    <link rel="stylesheet" href="{% static 'tf/css/tiny-slider.css' %}" />
    <link rel="stylesheet" href="{% static 'tf/css/aos.css' %}" />
    <link rel="stylesheet" href="{% static 'tf/css/style.css' %}" />
    <link rel="stylesheet" href="{% static 'fontawesome/css/all.css' %}" />
    <!-- <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}" /> -->
    <style>em{color: blue; font-weight: bold; font-size: 1.1rem;}</style>
    <title>
      DaRentals | {{rental.address}}
    </title>
  </head>
  <body>
    <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close">
          <span class="icofont-close js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>

    
    <nav class="site-nav">
      <div class="container">
        <div class="menu-bg-wrap">
          <div class="site-navigation">
            {% if user.is_authenticated %}
            <a href="{% url 'home' %}" class="fs-sm-6 fs-xs-6 fs-md-5 logo m-0 float-start">DaRentals - 
              <a href="{% url 'my-profile' user.username %}" class="logo mx-1 float-start">
                <!-- {{user}} {% if user.profile.is_premium %}<a href="#plans" class="text-warning fw-bold">Premium</a>{% else %}<a href="{% url 'subscription_page' %}" class="text-warning fw-bold">Go Premium</a>{% endif %} -->
              </a>
            </a>
            {% else %}
            <a href="{% url 'home' %}" class="logo m-0 float-start">DaRentals</a>
            {% endif %}

            <ul
              class="js-clone-nav d-none d-lg-inline-block text-start site-menu float-end"
            >
              <li class="active"><a href="{% url 'home' %}">Home</a></li>
              <li class="has-children">
                <a href="{% url 'rentals' %}">Rentals</a>
                <ul class="dropdown">
                  {% if user.is_authenticated %}
                    <!-- <li><a href="{% url 'rented-rentals' %}">Rented rentals</a></li> -->
                  {% endif %}
                  <!-- <li><a href="{%url 'availabe-rentals' %}">Available rentals</a></li> -->
                  <li><a href="{% url 'apartments' %}">Apartmemnts</a></li>
                  <li><a href="{% url 'business-properties' %}">Business rentals</a></li>
                  <li class="has-children">
                    <a href="{% url 'rooms' %}">Rooms</a>
                    <ul class="dropdown">
                      <li><a href="{% url 'student-dorms' %}">Student dorms</a></li>
                      <li><a href="{% url 'rooms' %}">Rooms</a></li>
                    </ul>
                  </li>
                </ul>
              </li>
              {% if user.is_authenticated %}
                <li><a href="{% url 'post-rental' %}">Post Rental</a></li>
                <li><a href="{% url 'my-profile' user.username %}">Dashboard</a></li>
                <li><a class="text-danger fw-bold" href="{% url 'u_sure_u_wanna_logout' %}">Logout</a></li>
              {% endif %}
              <li><a href="{% url 'terms-of-use' %}">Terms of use</a></li>
            </ul>

            <a
              href="#"
              class="burger light me-auto float-end mt-1 site-menu-toggle js-menu-toggle d-inline-block d-lg-none"
              data-toggle="collapse"
              data-target="#main-navbar"
            >
              <span></span>
            </a>
          </div>
        </div>
      </div>
    </nav>


    <div
      class="hero page-inner overlay"
      style="background-image: url({{rental.images.first.image.url}})"
    >
      <div class="container">
        <div class="row justify-content-center align-items-center">
          <div class="col-lg-9 text-center mt-5">
            <h1 class="heading" data-aos="fade-up">
              {{rental.address}}
            </h1>

            <nav
              aria-label="breadcrumb"
              data-aos="fade-up"
              data-aos-delay="200"
            >
              <ol class="breadcrumb text-center justify-content-center">
                <li class="breadcrumb-item"><a href="{% url 'home-page' %}">Home</a></li>
                <li class="breadcrumb-item">
                  <a href="{% url 'rentals' %}">Rentals</a>
                </li>
                <li
                  class="breadcrumb-item active text-white-50"
                  aria-current="page"
                >
                  {{rental.address}}
                </li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="container">
        <div class="row justify-content-between">
          <div class="col-lg-7">
            <div class="img-property-slide-wrap">
              <div class="img-property-slide">
                {% for image in rental.images.all %}
                <a href="{{image.image.url}}"><img src="{{image.image.url}}" alt="Image" class="img-fluid" /></a>
                {% endfor %}
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <h2 class="heading text-primary">{{rental.address}}</h2>
            <p class="meta">{{rental.user.profile.address}}</p>
            <p class="text-black-50">{{rental.details}}</p>
            {% if rental.type_of_rental == 'room' %}
              <em>Room</em>
            {% elif rental.type_of_rental == 'apartment' %}
              <em>Apartment</em>
            {% elif rental.type_of_rental == 'student_dorm' %}
              <em>Student dorm room</em>
            {% elif rental.type_of_rental == 'business_property' %}
              <em>Business Property</em>
            {% endif %}
            <div class="specs d-flex mb-4">
              <span class="d-block d-flex align-items-center me-3">
                <span class="icon-bed me-2"></span>
                <span class="caption">{{rental.beds}} beds</span>
              </span>
              <span class="d-block d-flex align-items-center">
                <span class="icon-bath me-2"></span>
                <span class="caption">{{rental.baths}} baths</span>
              </span>
            </div>
            <p class="text-black-50">{{rental.upload_date}}</p>
            {% if user.is_authenticated %}
              {% if user.username == rental.user.username %}
                  <a href="{% url 'edit-rental' rental.id %}"><button class="btn btn-dark">Edit</button></a>
                  <!-- <p>Money made: {% if user.profile.is_premium %} <span class="text-success">{{rental.money_made}}</span> {% else %} <a href="{% url 'subscription_page' %}">Go premium to see how much money your rental made for you</a> {% endif %}</p> -->
              {% else %}
                {% if rental.is_occupied %}
                  <button class="btn btn-warning"><span class="fa-solid fa-lock"></span> OCCUPIED</button>
                {% else %}
                  <!-- <a href="{% url 'checkout' rental.id %}"><button class="btn btn-success"><span class="fa-solid fa-hand-holding-usd"></span> Rent</button></a> -->
                  <a href="tel://{{rental.user.profile.phone_number}}" target="_blank"><button class="btn btn-success"><span class="fa-solid fa-phone"></span> Interested</button></a>
                {% endif %}
              {% endif %}
                <div style="overflow-x: auto; white-space: nowrap; margin: 1.4em .1em">
                  {% if user_rating and user_rating.liked %}
                    <div style="display: inline-block; margin-right: 1em;">
                      <a href="#" onclick="rateRental({{rental.id}}, 'undo'); return false;"><i class="fas fa-thumbs-up text-success fs-3"></i></a>
                      <p id="likes">{{likes}}</p>
                    </div>
                  {% else %}
                    <div style="display: inline-block; margin-right: 1em;">
                      <a href="#" onclick="rateRental({{rental.id}}, 'like'); return false;"><i class="fas fa-thumbs-up fs-3"></i></a>
                      <p id="likes">{{likes}}</p>
                    </div>
                  {% endif %}

                  {% if user_rating and not user_rating.liked %}
                    <div style="display: inline-block;">
                      <a href="#" onclick="rateRental({{rental.id}}, 'undo'); return false;"><i class="fas fa-thumbs-down text-danger fs-3"></i></a>
                      <p id="dislikes">{{dislikes}}</p>
                    </div>
                  {% else %}
                    <div style="display: inline-block;">
                      <a href="#" onclick="rateRental({{rental.id}}, 'dislike'); return false;"><i class="fas fa-thumbs-down fs-3"></i></a>
                      <p id="dislikes">{{dislikes}}</p>
                    </div>
                  {% endif %}
                  
                  <div class="text-success fw-bold" id="rating">
                    <!-- likes rating percentage -->
                  </div>
                </div>
                <script>
                  let likes = Number(document.getElementById('likes').textContent);
                  let dislikes = Number(document.getElementById('dislikes').textContent)
                  let rating = document.getElementById('rating');
                  let ratingPercentage = likes/(likes+dislikes) * 100
                  if (!isNaN(ratingPercentage)) {
                    rating.textContent = `Rating: ${ratingPercentage}%`;
                  } else {
                    rating.textContent = `Rating: 0%`
                  }
                  // Like and dislike logic using AJAX
                  async function rateRental(rentalId, action) {
                    const response = await fetch(`/rental/${rentalId}/${action}`, {
                      method: "POST",
                      headers: {
                        "X-CSRFToken": "{{csrf_token}}",
                        "X-Requested-With": "XMLHttpRequest"
                      }
                    });

                    const data = await response.json();
                    console.log(data);
                    if (data.status === 'created' || data.status === 'updated' || data.status === 'removed') {
                      if (data.likes !== undefined) {
                        document.getElementById('likes').textContent = data.likes;
                      }
                      if (data.dislikes !== undefined) {
                        document.getElementById("dislikes").textContent = data.dislikes;
                      }
                    }
                    window.location.reload();
                  }
                </script>
            {% else %}
              <a href="tel://{{rental.user.profile.phone_number}}" target="_blank"><button class="btn btn-success"><span class="fa-solid fa-phone"></span> Interested</button></a>
              <!-- <a href="{% url 'login' %}" class="btn btn-warning px-2 py-2">Login to rent this rental</a> -->
            {% endif %}

            <div class="d-block agent-box p-5">
              <a href="{% url 'my-profile' rental.user.username %}"><div class="img mb-4">
                <img
                  src="{{rental.user.profile.image.url}}"
                  alt="Image"
                  class="img-fluid"
                />
              </div></a>
              <div class="text">
                <h3 class="mb-0">{{rental.user.username}}</h3>
                <div class="meta mb-3">Landlord</div>
                <p>{{rental.user.profile.address}}</p>
                <ul class="list-unstyled social dark-hover d-flex">
                  <li class="me-1">
                    <a href="{% url 'my-profile' rental.user.username %}"><span class="fa-solid fa-person"></span></a>
                  </li>
                  <li class="me-1">
                    <a href="{% url 'my-profile' rental.user.username %}"><span class="fa-solid fa-home"></span></a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    
<div class="site-footer">
  <div class="container">
    <div class="row">
      
      <!-- Contact Column -->
      <div class="col-lg-4">
        <div class="widget">
          <h3>Contact</h3>
          <address>Polokwane, Moletjie</address>
          <ul class="list-unstyled links">
            <li><a target="_blank" href="tel://+27678558799">+27 67 855 8799</a></li>
            <li><a target="_blank" href="tel://+27671389102">+27 67 138 9102</a></li>
            <li><a target="_blank" href="mailto:darentals.saas@gmail.com">darentals.saas@gmail.com</a></li>
          </ul>
        </div>
      </div>

      <!-- Sources Column -->
      <div class="col-lg-4">
        <div class="widget">
          <h3>Sources</h3>
          <ul class="list-unstyled float-start links">
            <li><a href="{% url 'home' %}">Home</a></li>
            <!-- <li><a href="{% url 'people-with-rooms' %}">Landlords</a></li> -->
            {% if user.is_authenticated %}
              <li><a href="{% url 'post-rental' %}">Post Rental</a></li>
              <!-- <li><a href="{% url 'rented-rentals' %}">Rented Rentals</a></li> -->
            {% endif %}
            <li><a href="{% url 'rentals' %}">All Rentals</a></li>
          </ul>
          <ul class="list-unstyled float-start links">
            <li><a href="{% url 'rooms' %}">Rooms</a></li>
            <li><a href="{% url 'apartments' %}">Apartments</a></li>
            <li><a href="{% url 'student-dorms' %}">Student Dorms</a></li>
            <li><a href="{% url 'business-properties' %}">Business Properties</a></li>
            {% if user.is_authenticated %}
              <!-- <li><a href="{% url 'my-payments' %}">My Payments</a></li> -->
              <!-- <li><a href="{% url 'subscribe' %}">Subscribe</a></li> -->
              <!-- <li><a href="{% url 'subscription_page' %}">Go Premium</a></li> -->
            {% endif %}
          </ul>
        </div>
      </div>

      <!-- Links Column -->
      <div class="col-lg-4">
        <div class="widget">
          <h3>Links</h3>
          <ul class="list-unstyled links">
            <li><a href="{% url 'terms-of-use' %}">Terms of Use</a></li>
            <!-- <li><a href="{% url 'search' %}">Search</a></li> -->
            <!-- <li><a href="{% url 'secret_656profiles' %}">Secret Profiles</a></li> -->
             {% if not user.is_authenticated %}
            <li><a href="{% url 'sign-up' %}">Sign Up</a></li>
            <li><a href="{% url 'login' %}">Login</a></li>
            {% else %}
            <li><a href="{% url 'u_sure_u_wanna_logout' %}">Logout</a></li>
            {% endif %}
          </ul>

          <ul class="list-unstyled social">
            <li><a target="_blank" href="https://www.instagram.com/darentals"><span class="icon-instagram"></span></a></li>
            <!-- <li><a target="_blank" href="#"><span class="icon-twitter"></span></a></li> -->
            <li><a target="_blank" href="https://web.facebook.com/profile.php?id=61578741312506" target="_blank"><span class="icon-facebook"></span></a></li>
            <!-- <li><a target="_blank" href="#"><span class="icon-linkedin"></span></a></li>
            <li><a target="_blank" href="#"><span class="icon-pinterest"></span></a></li>
            <li><a target="_blank" href="#"><span class="icon-dribbble"></span></a></li> -->
          </ul>
        </div>
      </div>

    </div>

    <div class="row mt-5">
      <div class="col-12 text-center">
        <p>
          Copyright &copy;
          <script>document.write(new Date().getFullYear());</script>
          . All Rights Reserved. &mdash; Designed with love by
          <a href="https://untree.co">Untree.co</a>
        </p>
        <div>
          Distributed by
          <a href="https://themewagon.com/" target="_blank">themewagon</a>
        </div>
        <div> <br>
          Founded by Mphaki N.P
        </div>
        <div>
          Developed by Mashamaite H.M
        </div>
      </div>
    </div>

  </div>
</div>

    <!-- /.site-footer -->

    <!-- Preloader -->
    <!-- <div id="overlayer"></div>
    <div class="loader">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div> -->

    <script src="{% static 'tf/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'tf/js/tiny-slider.js' %}"></script>
    <script src="{% static 'tf/js/aos.js' %}"></script>
    <script src="{% static 'tf/js/navbar.js' %}"></script>
    <script src="{% static 'tf/js/counter.js' %}"></script>
    <script src="{% static 'tf/js/custom.js' %}"></script>
  </body>
</html>

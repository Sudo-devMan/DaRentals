
{% extends 'base.html' %}
{% load static %}
{% block title %}My rentals{% endblock %}

{% block body %}
	<br>
	<h1 class="text-center text-success display-5">Rented rentals history</h1>
	<p class="text-center opacity-75">Rent payments total: R {{rents_total}}</p>

	<div class="rentals-container container mt-5">
        {% if rented %}
            <div class="row">
                {% for rented_rental in rented %}
                    <div class="col-12 col-sm-6 col-md-4 mb-4">
                        <div class="card bg-dark text-light shadow-lg h-100 rounded-4 overflow-hidden">
                            <a href="{{rented_rental.rental.image.url}}"><img src="{{ rented_rental.rental.image.url }}" class="card-img-top" style="height: 200px; object-fit: cover;" alt="rental image" /></a>
                            <div class="card-body">
                                <h4 class="card-title text-white fw-bold">{{ rented_rental.rental.address }}</h4>
                                <p class="card-text text-light opacity-75" style="font-size: .9rem; color: #afafaf">{{ rented_rental.rental.details|truncatewords:15 }}<a href="{% url 'rental' rented_rental.rental.id %}" style="font-weight: bold">View more</a></p>
                            </div>
                            <div class="card-body border-top border-secondary d-flex justify-content-between align-items-center">
                                <p class="fs-4 text-success mb-0">R{{ rented_rental.rental.price }} pm</p>
                                {% if rented_rental.rental.is_occupied %}
                                <p class="fs-6 text-warning mb-0">OCCUPIED</p>
                                {% endif %}
                                
                                <a href="{% url 'rental' rented_rental.rental.id %}" class="btn btn-outline-secondary btn-sm">See</a>
                            </div>
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <a href="{% url 'my-profile' rented_rental.rental.user.username %}" class="text-decoration-none text-light d-flex align-items-center gap-2">
                                    <img src="{{ rented_rental.rental.user.profile.image.url }}" class="rounded-circle" style="width: 2em;" alt="Profile picture" />
                                    <span>{{ rented_rental.rental.user.username }}</span>
                                </a>
                                <form method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="profile_id" value="{{ rented_rental.rental.user.profile.id }}" />
                                    {% if profile in rented_rental.rental.user.profile.followed_by.all %}
                                        <button class="btn btn-success w-100" name="follow" value="unfollow" type="submit">Unfollow</button>
                                    {% else %}
                                        <button class="btn btn-outline-primary w-100" name="follow" value="follow" type="submit">Follow</button>
                                    {% endif %}
                                </form>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="text-center text-light my-5"><br><br><br><br><br><br><br>
                <h2 class="mb-3">Eishh... nothing here yet</h2>
                <p class="fs-5">
                    No <span class="text-danger">rooms</span>, <span class="text-danger">apartments</span>, or <span class="text-danger">business properties</span> rented. <a href="{% url 'home-page' %}">Browse some</a><br><br><br><br><br><br><br>
                </p>
            </div>
            <br><br><br>
        {% endif %}
    </div>

{% endblock %}